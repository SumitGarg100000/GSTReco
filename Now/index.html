
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free GST Reconciliation tool who reconcile your data within a seconds.
This GST Reconciliation Tool is designed to help you easily compare and match your GST data from GSTR-2B and GSTR-3B/books. This guide will walk you through the process step by step.

Step-by-Step Guide
Log in: Use your username and password to access the tool.
Download Sample File: Click on "Download Sample Excel File" to get a template for your data.
Prepare Your Data: Enter your GSTR-2B data in GST Portal sheet and GSTR-3B or books in client data sheet according to the sample file.
Upload File: Upload your prepared Excel file using the "Upload GST Data File" option.
Set Difference Allowed: Adjust the tolerance for differences in amounts (default is 1).
Enable Detailed Reconciliation: Check this box for detailed reconciliation or leave unchecked for a simple simple reconciliation.
Enable Filters (Optional): Use filters to sort or search through your data.
Reconcile Data: Click "Reconcile" to process and match your data.
Review Results: Check the GSTR-2B, GSTR-3B, and Summary tables for matched data.
Edit Data (If Needed): Make direct edits in the tables and reconcile again.
Download Output: Click "Download Reconciled Data" to save the results.
Feature Descriptions
Login System: Secure access with username and password. Subscription status is verified upon login.
Sample File Download: Provides a template to ensure your data is correctly formatted.
File Upload: Upload your GST data in Excel (.xlsx) format.
Difference Allowed: Set the acceptable difference in taxable value, IGST, CGST, and SGST for matching (default: 1).
Detailed Reconciliation: When enabled, shows detailed match criteria; when disabled, shows a simplified "Match" or "Unmatch".
Enable Filters: Adds dropdown filters to table columns for easy data sorting and searching.
Reconcile Button: Processes the data and updates the tables with match results.
Reset Data Button: Clears all uploaded data and resets the tool.
Editable Tables: Directly edit data in the tables; changes are reflected upon reconciling again.
Download Reconciled Data: Generates an Excel file with matched data, including color-coded rows for clarity.
Understanding Match Criteria
When Detailed Reconciliation is enabled, the tool uses the following criteria:

Match - GSTN, Invoice No., Date: Exact match on GSTN, invoice number, and date.
Match - GSTN, Invoice No.: Match on GSTN and invoice number, with possible date differences.
Match - GSTN, Date: Match on GSTN and date, with possible invoice number differences.
Match - GSTN: Match only on GSTN, with differences in invoice number and date.
Unmatch - GSTN Not Exist: GSTN from one sheet is not found in the other.
Unmatch - Amt Diff: Showing unmatch invoices due to amt difference
Unmatch: Data does not meet any match criteria, generally due to extra invoices in either GSTR-2B or GSTR-3B/Books
When Detailed Reconciliation is disabled, the criteria are simplified:

Match: Data matches based on any of the detailed criteria above.
Unmatch - GSTN Not Exist: GSTN from one sheet is not found in the other.
Unmatch - Amt Diff: Showing unmatch invoices due to amt difference
Unmatch: Data does not meet any match criteria, generally due to extra invoices in either GSTR-2B or GSTR-3B/Books">
    <meta name="keywords" content="GST,GST Reco, Reconciliation, GST Reconciliation, GSTR-2B, GSTR2B, GSTR-3B, GSTR3B, 2b vs 3b, gst.gov.in, https://www.gst.gov.in/, GST Login">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <meta property="og:title" content="GST Reconciliation">
    <meta property="og:image" content="https://sumitgarg100000.github.io/GSTReconciliation/Image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="GST Reconciliation Preview">
    <meta name="google-site-verification" content="FR7D2qkpciz6QmllRnOJ7Mv6bbsFJ1CA6Qn7mYDkqwE" />
    <title>GST Reconciliation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>



#login-section {
  display: flex;
  flex-direction: column;
  height: 100%; /* Login section ko pura height do */
}

.explanation {
  margin-top: 20px;
  padding: 20px;
  background-color: #f9f9f9;
  border: 1px solid #ddd;
  border-radius: 5px;
  overflow-y: auto; /* Scrollable banao agar content zyada ho */
  max-height: calc(100vh - 300px); /* Screen height se login form aur padding subtract karo */
  flex-grow: 1; /* Baki space ko fill kare */
}

.explanation h2, .explanation h3 {
  color: #00796b;
}

.explanation ul, .explanation ol {
  margin-left: 20px;
}



      
      .whatsapp-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #25d366;
        color: white;
        border-radius: 50%;
        padding: 25px;
        text-align: center;
        box-shadow: 0 0 20px 10px rgba(37, 211, 102, 0.1);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        width: 100px;
        height: 100px;
        animation: glow 3s infinite;
        transition: all 0.3s ease;
      }
      .whatsapp-btn:hover {
        background-color: #128C7E;
        transform: scale(1.1);
        animation-play-state: paused;
      }
      .whatsapp-btn i {
        font-size: 60px;
        transition: transform 0.3s ease;
      }
      @keyframes glow {
        0% { box-shadow: 0 0 20px 0px rgba(37, 211, 102, 0.2); transform: scale(1); }
        50% { box-shadow: 0 0 40px 20px rgba(37, 211, 102, 0.1); transform: scale(1.05); }
        100% { box-shadow: 0 0 20px 0px rgba(37, 211, 102, 0.2); transform: scale(1); }
      }
      .whatsapp-btn::after {
        content: '';
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        border-radius: 50%;
        background: radial-gradient(circle, rgba(37, 211, 102, 0.15) 0%, rgba(37, 211, 102, 0) 70%);
        animation: sparkle 3s infinite;
      }
      @keyframes sparkle {
        0% { opacity: 0.3; transform: scale(0.8); }
        50% { opacity: 0; transform: scale(1.5); }
        100% { opacity: 0.3; transform: scale(0.8); }
      }
      .instructions-btn {
        position: fixed;
        bottom: 130px;
        right: 20px;
        background-color: #007bff;
        color: white;
        border-radius: 50%;
        padding: 25px;
        text-align: center;
        box-shadow: 0 0 20px 10px rgba(0, 123, 255, 0.1);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100px;
        height: 100px;
        animation: glow 3s infinite;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
      }
      .instructions-btn:hover {
        background-color: #0056b3;
        transform: scale(1.1);
        animation-play-state: paused;
      }
      .instructions-btn i {
        font-size: 60px;
        transition: transform 0.3s ease;
      }
      .instructions-btn::after {
        content: '';
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        border-radius: 50%;
        background: radial-gradient(circle, rgba(0, 123, 255, 0.15) 0%, rgba(0, 123, 255, 0) 70%);
        animation: sparkle 3s infinite;
      }
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 2000;
      }
      .modal-content {
        background-color: #fff;
        margin: 5% auto;
        padding: 20px;
        border-radius: 10px;
        width: 80%;
        max-width: 500px;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        position: relative;
      }
      .close-btn {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 24px;
        color: #333;
        cursor: pointer;
        border: none;
        background: none;
      }
      .close-btn:hover {
        color: #ff0000;
      }
      .modal-content h2 {
        color: #00796b;
        margin-bottom: 15px;
      }
      .modal-content p {
        line-height: 1.6;
        color: #333;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-size: 100%;
        font-family: inherit;
      }
      body {
        font-family: 'Segoe UI', Arial, sans-serif;
        margin: 0;
        padding: 30px;
        background: #F8F9FA;
        color: #333;
      }
      .container {
        max-width: 1300px;
        margin: 0 auto;
        background: #fff;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
        color: #00796b;
        font-size: 2.5em;
        margin-bottom: 20px;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
      }
      h2 {
        text-align: center;
        color: #004d40;
        font-size: 1.8em;
        margin: 20px 0;
      }
      .upload-section, .input-section {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        gap: 20px;
      }
      .upload-section div, .input-section div {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      label {
        font-weight: bold;
        color: #00695c;
      }
      input[type="file"], input[type="number"], input[type="checkbox"], input[type="text"], input[type="password"] {
        padding: 10px;
        border: 2px solid #26a69a;
        border-radius: 5px;
        background: #f1f8e9;
        transition: border-color 0.3s;
        font-size: 1em;
      }
      input[type="file"]:hover, input[type="number"]:hover, input[type="text"]:hover, input[type="password"]:hover {
        border-color: #00796b;
      }
      .data-container {
        margin: 30px 0;
      }
      .table-container {
    overflow-x: auto;
    overflow-y: auto;
    max-height: 1200px; /* Adjusted for ~50 rows */
    margin: 10px 0;
    border: 1px solid #b0bec5;
    border-radius: 8px;
    padding: 15px;
    background: #fafafa;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    position: relative;
  }

  table thead th {
    position: sticky;
    top: 0;
    background: #e0ffff;
    z-index: 10;
    border-bottom: 1px solid #cfd8dc;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
    margin-top: 0;
  }
      th, td {
        border: 1px solid #cfd8dc;
        padding: 12px;
        text-align: left;
        font-size: 14px;
      }
      th {
        background: #e0ffff;
        color: #004d40;
        font-weight: bold;
      }
      button {
        display: inline-block;
        margin: 10px;
        padding: 12px 30px;
        background: linear-gradient(45deg, #26a69a, #00796b);
        color: white;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-size: 1.1em;
        transition: transform 0.2s, box-shadow 0.2s;
      }
      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
      }
      #reset-btn {
        background: linear-gradient(45deg, #ff4444, #cc0000);
      }
      #reset-btn:hover {
        background: linear-gradient(45deg, #cc0000, #ff4444);
      }
      a#download-sample, a#download-output {
        display: block;
        text-align: center;
        margin: 20px auto;
        color: #00796b;
        text-decoration: none;
        font-weight: bold;
        transition: color 0.3s;
      }
      a#download-sample:hover, a#download-output:hover {
        color: #004d40;
      }
      .match-gstn-inv-date { background-color: #00ced1 !important; color: white !important; }
.match-inv { background-color: #4b0082 !important; color: white !important; }
.match-gstn-date { background-color: #32cd32 !important; color: white !important; }
.match-gstn { background-color: #ffbf00 !important; }
.gstn-not-match { background-color: #dc143c !important; color: white !important; }
.amt-diff { background-color: #ff4500 !important; color: white !important; }
.no-match { background-color: #ff00ff !important; color: white !important; }
.match { background-color: #00ced1 !important; color: white !important; }
      [contenteditable="true"], [contenteditable="true"] * {
        font-size: 9px !important;
      }
      #summary-container table th, #summary-container table td,
      #summary-container table th *, #summary-container table td * {
        font-size: 9px !important;
      }
      footer {
        background: #2C3E50;
        color: #FFFFFF;
        padding: 1rem;
        width: 100%;
      }
      .footer-content {
        max-width: 1200px;
        margin: 0 auto;
        text-align: center;
      }
      .footer-links {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin: 1rem 0;
        flex-wrap: wrap;
      }
      .footer-links a {
        color: #FFFFFF;
        text-decoration: none;
        opacity: 0.9;
        transition: opacity 0.3s ease;
      }
      .footer-links a:hover {
        opacity: 1;
        text-decoration: underline;
      }
      #login-section, #tool-section {
        transition: opacity 0.5s;
      }
      #login-section.hidden, #tool-section.hidden {
        display: none;
      }
      #error {
        color: red;
        text-align: center;
        margin-top: 10px;
      }
      .button-container {
        text-align: center;
        margin: 30px 0;
      }
      @media (max-width: 768px) {
        .upload-section, .input-section { flex-direction: column; }
        .container { padding: 20px; }
        h1 { font-size: 2em; }
        [contenteditable="true"], [contenteditable="true"] * { font-size: 14px !important; }
        #summary-container table th, #summary-container table td,
        #summary-container table th *, #summary-container table td * { font-size: 14px !important; }
        footer { padding: 0.75rem; }
        .footer-links { gap: 1.5rem; }
      }
      @media (max-width: 480px) {
        .footer-links { flex-direction: column; gap: 0.5rem; }
      }
    </style>
   
   <style>
/* Existing Filter Dropdown Styles */
.filter-dropdown {
  position: relative;
  display: inline-block;
}

.filter-btn {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 14px;
  color: #004d40;
  padding: 0;
  margin-left: 5px;
}

.filter-dropdown-content {
  display: none;
  position: absolute;
  background-color: #fff;
  min-width: 200px;
  max-height: 300px;
  overflow-y: auto;
  border: 1px solid #b0bec5;
  border-radius: 4px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  z-index: 20;
}

.filter-dropdown-content.show {
  display: block;
}

/* Sort Actions Styling */
.sort-actions {
  padding: 5px;
  border-top: 1px solid #b0bec5;
  display: flex;
  justify-content: space-between;
}

.sort-actions button {
  background: #00796b;
  color: white;
  border: none;
  padding: 5px 10px;
  margin: 0 2px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
}

.sort-actions button:hover {
  background: #004d40;
}
</style>

   
  </head>
  <body>
    <div class="container">
      <!-- Login Section -->
      <div id="login-section">
        <h1>Login to GST Reconciliation Tool</h1>
        <div class="input-section">
          <div>
            <label for="username">Username:</label>
            <input type="text" id="username" value="" placeholder="Enter username">
          </div>
          <div>
            <label for="password">Password:</label>
            <input type="password" id="password" value="" placeholder="Enter password">
          </div>
        </div>
        <button onclick="login()">Login</button>
  <button onclick="freeServiceLogin()" style="background: linear-gradient(45deg, #ff9800, #f44336); margin-left: 10px;">Free Service Login</button>
  <p id="error"></p>


<div class="explanation" id="explanation-container">
  <h2>How to Use the GST Reconciliation Tool</h2>
  <p>The GST Reconciliation Tool is designed to help you easily compare and match your GST data from GSTR-2B and GSTR-3B. This guide will walk you through the process step by step.</p>
  
  <h3>Step-by-Step Guide</h3>
  <ol>
    <li><strong>Log in</strong>: Use your username and password to access the tool.</li>
    <li><strong>Download Sample File</strong>: Click on "Download Sample Excel File" to get a template for your data.</li>
    <li><strong>Prepare Your Data</strong>: Enter your GSTR-2B data in GST Portal sheet and GSTR-3B or books in client data sheet according to the sample file.</li>
    <li><strong>Upload File</strong>: Upload your prepared Excel file using the "Upload GST Data File" option.</li>
    <li><strong>Set Difference Allowed</strong>: Adjust the tolerance for differences in amounts (default is 1).</li>
    <li><strong>Enable Detailed Reconciliation</strong>: Check this box for detailed reconciliation or leave unchecked for a simple reconciliation.</li>
    <li><strong>Enable Filters (Optional)</strong>: Use filters to sort or search through your data.</li>
    <li><strong>Reconcile Data</strong>: Click "Reconcile" to process and match your data.</li>
    <li><strong>Review Results</strong>: Check the GSTR-2B, GSTR-3B, and Summary tables for matched data.</li>
    <li><strong>Edit Data (If Needed)</strong>: Make direct edits in the tables and reconcile again.</li>
    <li><strong>Download Output</strong>: Click "Download Reconciled Data" to save the results.</li>
  </ol>
  
  <h3>Feature Descriptions</h3>
  <ul>
    <li><strong>Login System</strong>: Secure access with username and password. Subscription status is verified upon login.</li>
    <li><strong>Sample File Download</strong>: Provides a template to ensure your data is correctly formatted.</li>
    <li><strong>File Upload</strong>: Upload your GST data in Excel (.xlsx) format.</li>
    <li><strong>Difference Allowed</strong>: Set the acceptable difference in taxable value, IGST, CGST, and SGST for matching (default: 1).</li>
    <li><strong>Detailed Reconciliation</strong>: When enabled, shows detailed match criteria; when disabled, shows a simplified "Match" or "Unmatch".</li>
    <li><strong>Enable Filters</strong>: Adds dropdown filters to table columns for easy data sorting and searching.</li>
    <li><strong>Reconcile Button</strong>: Processes the data and updates the tables with match results.</li>
    <li><strong>Reset Data Button</strong>: Clears all uploaded data and resets the tool.</li>
    <li><strong>Editable Tables</strong>: Directly edit data in the tables; changes are reflected upon reconciling again.</li>
    <li><strong>Download Reconciled Data</strong>: Generates an Excel file with matched data, including color-coded rows for clarity.</li>
  </ul>
  
  <h3>Understanding Match Criteria</h3>
  <p>When <strong>Detailed Reconciliation</strong> is enabled, the tool uses the following criteria:</p>
  <ul>
    <li><strong>Match - GSTN, Invoice No., Date</strong>: Exact match on GSTN, invoice number, and date.</li>
    <li><strong>Match - GSTN, Invoice No.</strong>: Match on GSTN and invoice number, with possible date differences.</li>
    <li><strong>Match - GSTN, Date</strong>: Match on GSTN and date, with possible invoice number differences.</li>
    <li><strong>Match - GSTN</strong>: Match only on GSTN, with differences in invoice number and date.</li>
    <li><strong>Unmatch - GSTN Not Exist</strong>: GSTN from one sheet is not found in the other.</li>
    <li><strong>Unmatch - Amt Diff</strong>: GSTN and Invoice Number match, but amounts (Taxable Value, IGST, CGST, SGST) differ by more than the allowed difference.</li>
    <li><strong>Unmatch</strong>: Data does not meet any match criteria, generally due to extra invoices in either GSTR-2B or GSTR-3B/Books</li>
  </ul>
  <p>When <strong>Detailed Reconciliation</strong> is disabled, the criteria are simplified:</p>
  <ul>
    <li><strong>Match</strong>: Data matches based on any of the detailed criteria above.</li>
    <li><strong>Unmatch - GSTN Not Exist</strong>: GSTN from one sheet is not found in the other.</li>
    <li><strong>Unmatch - Amt Diff</strong>: GSTN and Invoice Number match, but amounts (Taxable Value, IGST, CGST, SGST) differ by more than the allowed difference.</li>
    <li><strong>Unmatch</strong>: Data does not meet any match criteria, generally due to extra invoices in either GSTR-2B or GSTR-3B/Books</li>
  </ul>
</div>


        
      </div>

      <!-- Tool Section -->
      <div id="tool-section" class="hidden">
        <h1>GST Reconciliation Tool</h1>
        <button onclick="logout()">Logout</button>
        <a href="#" id="download-sample">Download Sample Excel File</a>
        <div class="input-section">
          <div>
            <label for="diff-allowed">Difference Allowed (Default: 1):</label>
            <input type="number" id="diff-allowed" value="1" min="0" placeholder="0 if blank">
          </div>
        </div>
        <div class="upload-section">
          <div>
            <label for="gst-file">Upload GST Data File (GSTR-2B & GSTR-3B):</label>
            <input type="file" id="gst-file" accept=".xlsx">
          </div>
        </div>
        <div style="text-align: center; margin: 10px 0;">
          <input type="checkbox" id="detailed-reconciliation" name="detailed-reconciliation">
          <label for="detailed-reconciliation">Detailed Reconciliation</label>
        </div>

        <div style="text-align: center; margin: 10px 0;">
  <input type="checkbox" id="enable-filter" name="enable-filter">
  <label for="enable-filter">Enable Filters</label>
        </div>
        <div class="data-container">
          <h2>GSTR-2B Data</h2>
          <div id="gstr2b-container" class="table-container"></div>
          <h2>Client Data</h2>
          <div id="gstr3b-container" class="table-container"></div>
          <h2>Summary</h2>
          <div id="summary-container" class="table-container"></div>
        </div>
        <div class="button-container">
          <button id="reconcile-btn">Reconcile</button>
          <button id="reset-btn">Reset Data</button>
        </div>
        <div id="output-link" style="display: none;">
          <h3>Reconciled Output:</h3>
          <a id="download-output" href="#">Download Reconciled Data</a>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
   <script>
      
      const users = {
        "Sumitgarg" : { password: "Garg@123", expiry: "2026-04-30"},
        "user1": { password: "pass123", expiry: "2025-04-30" },
        "user2": { password: "pass456", expiry: "2025-05-15" }
      };
    </script>
    
  
    

<script>
        //   if (window.location.href.toLowerCase(). includes("https://sumitgarg100000.github.io/GSTReconciliation/")) {
       let gstr2bData = localStorage.getItem('gstr2bData') ? JSON.parse(localStorage.getItem('gstr2bData')) : [];
  let gstr3bData = localStorage.getItem('gstr3bData') ? JSON.parse(localStorage.getItem('gstr3bData')) : [];
  const detailedReconciliationCheckbox = document.getElementById('detailed-reconciliation');

  // ***Change 1: Page Load Check ko Improve Karna***
  document.addEventListener("DOMContentLoaded", function() {
    const loggedInUser = localStorage.getItem("loggedInUser");
    if (loggedInUser && checkSubscription(loggedInUser)) { // <--- Highlight: Condition Simplified
      showTool(); // Agar user logged in hai aur subscription valid hai, to tool dikhao
    } else {
      showLogin(); // Warna login page dikhao
    }
  });

  // Login Function (No Change Needed)
  function login() {
  const username = document.getElementById("username").value;
  const password = document.getElementById("password").value;
  const error = document.getElementById("error");

  if (users[username] && users[username].password === password) {
    if (checkSubscription(username)) {
      localStorage.setItem("loggedInUser", username);
      localStorage.setItem("isFreeService", "false"); // Normal login
      showTool();
      // Clear input fields after successful login
      document.getElementById("username").value = "";
      document.getElementById("password").value = "";
      error.textContent = ""; // Clear error message if any

          } else {
      error.textContent = "Your subscription has expired!";
    }
  } else {
    error.textContent = "Invalid username or password!";
  }
}

  function freeServiceLogin() {
  localStorage.setItem("loggedInUser", "freeServiceUser");
  localStorage.setItem("isFreeService", "true"); // Free service flag
  showTool();
  restrictFreeServiceFeatures(); // Restrictions apply karo
  // Clear input fields after successful login
  document.getElementById("username").value = "";
  document.getElementById("password").value = "";
  document.getElementById("error").textContent = ""; // Clear error message if any
}

  // Check Subscription Expiry (No Change Needed)
  function checkSubscription(username) {
    const expiryDate = new Date(users[username].expiry);
    const today = new Date();
    return today <= expiryDate;
  }

  // Logout Function (No Change Needed)
  function logout() {
    localStorage.removeItem("loggedInUser");
    localStorage.removeItem("gstr2bData");
    localStorage.removeItem("gstr3bData");
    localStorage.removeItem("isFreeService"); // Free service flag clear karo
    gstr2bData = [];
    gstr3bData = [];
    resetData();
    showLogin();
    // Clear input fields and reset login section
  document.getElementById("username").value = "";
  document.getElementById("password").value = "";
  document.getElementById("error").textContent = ""; // Clear error message
   // Ensure fields are blank when showing login section
  document.getElementById("username").value = "";
  document.getElementById("password").value = "";
  document.getElementById("error").textContent = "";
  }
  

  // Show Login Section (No Change Needed)
  function showLogin() {
    document.getElementById("login-section").classList.remove("hidden");
    document.getElementById("tool-section").classList.add("hidden");
  }

  // ***Change 2: Show Tool Function ko Enhance Karna***
  function showTool() {
  document.getElementById("login-section").classList.add("hidden");
  document.getElementById("tool-section").classList.remove("hidden");

  const isFreeService = localStorage.getItem("isFreeService") === "true";

  // Restore checkbox state only for normal users
  const detailedReconciliationCheckbox = document.getElementById("detailed-reconciliation");
  detailedReconciliationCheckbox.checked = localStorage.getItem('detailedReconciliation') === 'true' && !isFreeService;
  
  // Add event listeners only once (avoid duplicates)
  const reconcileBtn = document.getElementById('reconcile-btn');
  const downloadSample = document.getElementById('download-sample');
  const diffAllowed = document.getElementById('diff-allowed');
    diffAllowed.value = "1"; // Default to 1 for all users
  const resetBtn = document.getElementById('reset-btn');
  const gstFile = document.getElementById('gst-file');

  reconcileBtn.removeEventListener('click', reconcileData);
  downloadSample.removeEventListener('click', generateSampleFile);
  diffAllowed.removeEventListener('input', reconcileData);
  resetBtn.removeEventListener('click', resetData);
  gstFile.removeEventListener('change', handleFileUpload);

  gstFile.addEventListener('change', handleFileUpload);
  reconcileBtn.addEventListener('click', reconcileData);
  downloadSample.addEventListener('click', generateSampleFile);
  diffAllowed.addEventListener('input', reconcileData);
  resetBtn.addEventListener('click', resetData);

  detailedReconciliationCheckbox.removeEventListener('change', handleCheckboxChange);
  detailedReconciliationCheckbox.addEventListener('change', handleCheckboxChange);
  function handleCheckboxChange() {
    reconcileData();
    localStorage.setItem('detailedReconciliation', detailedReconciliationCheckbox.checked);
  }

  // Restore previous data
  if (gstr2bData.length > 0) {
    displayData(gstr2bData, 'gstr2b-container', gstr2bHeaders(), 'gstr2b');
  }
  if (gstr3bData.length > 0) {
    displayData(gstr3bData, 'gstr3b-container', gstr3bHeaders(), 'gstr3b');
  }
  if (gstr2bData.length > 0 || gstr3bData.length > 0) {
    reconcileData();
  }

  // Reset restrictions for normal users and apply for free service users
  const filterCheckbox = document.getElementById("enable-filter");
  if (!isFreeService) {
    detailedReconciliationCheckbox.disabled = false;
    filterCheckbox.disabled = false;
    diffAllowed.disabled = false;
    document.getElementById("free-service-notice")?.remove(); // Remove notice if exists
  }
  restrictFreeServiceFeatures(); // Apply restrictions if free service mode
}

function restrictFreeServiceFeatures() {
  const isFreeService = localStorage.getItem("isFreeService") === "true";
  
  if (isFreeService) {
    // Disable Detailed Reconciliation
    const detailedCheckbox = document.getElementById("detailed-reconciliation");
    detailedCheckbox.checked = false;
    detailedCheckbox.disabled = true;

    // Disable Filter Option
    const filterCheckbox = document.getElementById("enable-filter");
    filterCheckbox.checked = false;
    filterCheckbox.disabled = true;
    filterEnabled = false;
    toggleFilters(); // Filters ko hide karo

    // Disable Difference Allowed with default value 1
    const diffAllowedInput = document.getElementById("diff-allowed");
    diffAllowedInput.value = "1"; // Default to 1 for free users
    diffAllowedInput.disabled = true;

    // Disable Editable Fields in Existing Tables
    const tables = document.querySelectorAll("#gstr2b-container table, #gstr3b-container table");
    tables.forEach(table => {
      const rows = table.querySelectorAll("tbody tr");
      rows.forEach(row => {
        const cells = row.querySelectorAll("td");
        cells.forEach(cell => {
          cell.setAttribute("contenteditable", "false"); // Force disable
        });
      });
    });

    // Apply colors for free service mode
    applyFreeServiceColors();

    // Add notice
    const toolSection = document.getElementById("tool-section");
    const notice = document.createElement("p");
    notice.id = "free-service-notice";
    notice.style.color = "#f44336";
    notice.style.textAlign = "center";
    notice.textContent = "In Free Service: Detailed Reconciliation feature, Enable Filter & sorting option, alteration of Difference Allowed limit and facility of editable fields are disabled.";
    if (!document.getElementById("free-service-notice")) {
      toolSection.insertBefore(notice, toolSection.querySelector("h1").nextSibling);
    }
  }
}
      // Reset Data Function
      function resetData() {
        gstr2bData = [];
        gstr3bData = [];
        localStorage.removeItem('gstr2bData');
        localStorage.removeItem('gstr3bData');
        localStorage.setItem('detailedReconciliation', false);
        document.getElementById('gstr2b-container').innerHTML = '';
        document.getElementById('gstr3b-container').innerHTML = '';
        document.getElementById('summary-container').innerHTML = '';
        document.getElementById('output-link').style.display = 'none';
        document.getElementById('gst-file').value = ''; // Clear file input
        document.getElementById('diff-allowed').value = '1';
      }

      // New improved formatDate function
      function formatDate(dateValue) {
        if (!dateValue) return '';
        
        let date;
        // Handle Excel date numbers
        if (typeof dateValue === 'number' && dateValue > 0) {
          date = new Date((dateValue - 25569) * 86400 * 1000);
        } 
        // Handle date strings in various formats
        else if (typeof dateValue === 'string') {
          // Try to parse the date string
          const parts = dateValue.split(/[-\/\.]/);
          if (parts.length === 3) {
            // Check if the first part is day (1-31)
            if (parseInt(parts[0]) >= 1 && parseInt(parts[0]) <= 31) {
              // Try to create a valid date object
              date = new Date(parts[2], getMonthIndex(parts[1]), parts[0]);
            } else {
              // Otherwise, use standard date parsing
              date = new Date(dateValue);
            }
          } else {
            // For other formats, use standard date parsing
            date = new Date(dateValue);
          }
        } else {
          return dateValue;
        }
        
        // Check if date is valid
        if (isNaN(date.getTime())) return dateValue;
        
        // Format as dd-mmm-yyyy
        const day = String(date.getDate()).padStart(2, '0');
        const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        const month = monthNames[date.getMonth()];
        const year = date.getFullYear();
        
        return `${day}-${month}-${year}`;
      }

      // Helper function to convert month name or number to index
      function getMonthIndex(month) {
        const monthNames = {
          'jan': 0, 'january': 0, '01': 0, '1': 0,
          'feb': 1, 'february': 1, '02': 1, '2': 1,
          'mar': 2, 'march': 2, '03': 2, '3': 2,
          'apr': 3, 'april': 3, '04': 3, '4': 3,
          'may': 4, '05': 4, '5': 4,
          'jun': 5, 'june': 5, '06': 5, '6': 5,
          'jul': 6, 'july': 6, '07': 6, '7': 6,
          'aug': 7, 'august': 7, '08': 7, '8': 7,
          'sep': 8, 'september': 8, '09': 8, '9': 8,
          'oct': 9, 'october': 9, '10': 9,
          'nov': 10, 'november': 10, '11': 10,
          'dec': 11, 'december': 11, '12': 11
        };
        
        const normalizedMonth = String(month).toLowerCase();
        return monthNames[normalizedMonth] !== undefined ? monthNames[normalizedMonth] : parseInt(normalizedMonth) - 1;
      }

      // Helper function to process dates for storage
      function formatDateForStorage(dateStr) {
        // Try to parse and standardize the date format
        try {
          return formatDate(dateStr);
        } catch (e) {
          return dateStr;
        }
      }

      const baseGstr2bHeaders = ['Match Criteria', 'GSTN', 'Name of Supplier', 'Invoice Number', 'Invoice type', 'Invoice Date', 'Invoice Value', 'Place of supply', 'Reverse Charge', 'Rate (%)', 'Taxable Value', 'IGST', 'CGST', 'SGST'];
      const extendedGstr2bHeaders = ['Cess', 'GSTR-1/5 Period', 'GSTR-1/5 Filing Date', 'ITC Availability', 'Reason', 'Applicable % of Tax Rate', 'Source', 'IRN', 'IRN Date'];
      function gstr2bHeaders() { return [...baseGstr2bHeaders, ...extendedGstr2bHeaders]; }

      const baseGstr3bHeaders = ['Match Criteria', 'Invoice Date', 'GSTN', 'Name of Supplier', 'Invoice Number', 'Taxable Value', 'IGST', 'CGST', 'SGST'];
      const extendedGstr3bHeaders = ['Invoice Value'];
      function gstr3bHeaders() { return [...baseGstr3bHeaders, ...extendedGstr3bHeaders]; }

      function generateSampleFile(event) {
        event.preventDefault();
        const wb = XLSX.utils.book_new();
        const gstr2bSampleHeaders = gstr2bHeaders();
        const gstr2bSample = [
          gstr2bSampleHeaders,
        // Match - GSTN, Invoice No., Date (2 entries)
    ['Match - GSTN, Invoice No., Date', '27AABCU9603R1ZM', 'Supplier A', 'INV001', 'Regular', '01-Mar-2025', 11800, 'Maharashtra', 'N', 18, 10000, 1800, 0, 0, 0, 'Mar-2025', '15-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN001', '02-Mar-2025'],
    ['Match - GSTN, Invoice No., Date', '27AABCU9603R1ZM', 'Supplier A', 'inv001', 'Regular', '01-mar-2025', 5900, 'Maharashtra', 'N', 18, 5000, 900, 0, 0, 0, 'Mar-2025', '15-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN002', '02-Mar-2025'],
    // Match - GSTN, Invoice No. (2 entries, different dates)
    ['Match - GSTN, Invoice No.', '29XYZ1234P1ZQ', 'Supplier B', 'INV002', 'Regular', '02-Mar-2025', 23600, 'Karnataka', 'N', 9, 20000, 0, 1800, 1800, 0, 'Mar-2025', '16-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-5', 'IRN003', '03-Mar-2025'],
    ['Match - GSTN, Invoice No.', '29XYZ1234P1ZQ', 'Supplier B', 'INV004', 'Regular', '04-Mar-2025', 11800, 'Karnataka', 'N', 9, 10000, 0, 900, 900, 0, 'Mar-2025', '16-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-5', 'IRN004', '04-Mar-2025'],
    // Match - GSTN, Date (2 entries, different invoice numbers)
    ['Match - GSTN, Date', '33ABCDE5678F1Z5', 'Supplier C', 'INV0003', 'Regular', '04-Mar-2025', 14160, 'Tamil Nadu', 'N', 18, 12000, 2160, 0, 0, 0, 'Mar-2025', '17-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN005', '05-Mar-2025'],
    ['Match - GSTN, Date', '33ABCDE5678F1Z5', 'Supplier C', 'INV0004', 'Regular', '04-Mar-2025', 7080, 'Tamil Nadu', 'N', 18, 6000, 1080, 0, 0, 0, 'Mar-2025', '17-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN006', '05-Mar-2025'],
    // Match - GSTN (2 entries, different invoice numbers and dates)
    ['Match - GSTN', '27AABCU9603R2ZM', 'Supplier C', 'INV0005', 'Regular', '31-Mar-2025', 9440, 'Maharashtra', 'N', 18, 8000, 1440, 0, 0, 0, 'Mar-2025', '31-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN007', '06-Mar-2025'],
    ['Match - GSTN', '27AABCU9603R2ZM', 'Supplier C', 'INV0006', 'Regular', '31-Mar-2025', 4720, 'Maharashtra', 'N', 18, 4000, 720, 0, 0, 0, 'Mar-2025', '31-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN008', '07-Mar-2025'],
    // Unmatch - GSTN Not Exist (2 entries)
    ['Unmatch - GSTN Not Exist', '99NOTEXIST1234Z', 'Supplier X', 'INV007', 'Regular', '07-Mar-2025', 11800, 'Delhi', 'N', 18, 10000, 1800, 0, 0, 0, 'Mar-2025', '19-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN009', '08-Mar-2025'],
    ['Unmatch - GSTN Not Exist', '99NOTEXIST5678Z', 'Supplier Y', 'INV008', 'Regular', '08-Mar-2025', 5900, 'Delhi', 'N', 18, 5000, 900, 0, 0, 0, 'Mar-2025', '19-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN010', '09-Mar-2025'],
    // Unmatch - Amt Diff (2 entries, same invoice number, different amounts)
    ['Unmatch - Amt Diff', '27AABCU9603R1ZM', 'Supplier A', 'INV009', 'Regular', '09-Mar-2025', 11802, 'Maharashtra', 'N', 18, 10000, 1802, 0, 0, 0, 'Mar-2025', '20-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN011', '10-Mar-2025'],
    ['Unmatch - Amt Diff', '27AABCU9603R1ZM', 'Supplier A', 'INV009', 'Regular', '09-Mar-2025', 5900, 'Maharashtra', 'N', 5, 5000, 250, 0, 0, 0, 'Mar-2025', '20-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN012', '10-Mar-2025'],
    // Unmatch (2 entries, extra invoices)
    ['Unmatch', '27AABCU9603R1ZM', 'Supplier A', 'INV010', 'Regular', '10-Mar-2025', 7080, 'Maharashtra', 'N', 18, 6000, 1080, 0, 0, 0, 'Mar-2025', '21-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-1', 'IRN013', '11-Mar-2025'],
    ['Unmatch', '29XYZ1234P1ZQ', 'Supplier B', 'INV011', 'Regular', '11-Mar-2025', 9440, 'Karnataka', 'N', 9, 8000, 0, 720, 720, 0, 'Mar-2025', '22-Mar-2025', 'Yes', 'N/A', 0, 'GSTR-5', 'IRN014', '12-Mar-2025'],

  ];
        const ws1 = XLSX.utils.aoa_to_sheet(gstr2bSample);
        gstr2bSampleHeaders.forEach((_, index) => {
          const cell = ws1[XLSX.utils.encode_cell({ r: 0, c: index })];
          if (cell) cell.s = { fill: { fgColor: { rgb: 'E0FFFF' } } };
        });
        XLSX.utils.book_append_sheet(wb, ws1, 'GST Portal');

        const gstr3bSampleHeaders = gstr3bHeaders();
        const gstr3bSample = [
          gstr3bSampleHeaders,
          // Match - GSTN, Invoice No., Date (2 entries)
    ['Match - GSTN, Invoice No., Date', '01-Mar-2025', '27AABCU9603R1ZM', 'Supplier A', 'INV001', 10000, 1800, 0, 0, 11800],
    ['Match - GSTN, Invoice No., Date', '01-Mar-2025', '27AABCU9603R1ZM', 'Supplier A', 'inv001', 5000, 900, 0, 0, 5900],
    // Match - GSTN, Invoice No. (2 entries, different dates)
    ['Match - GSTN, Invoice No.', '03-Mar-2025', '29XYZ1234P1ZQ', 'Supplier B', 'INV002', 20000, 0, 1800, 1800, 23600],
    ['Match - GSTN, Invoice No.', '03-Mar-2025', '29XYZ1234P1ZQ', 'Supplier B', 'INV004', 10000, 0, 900, 900, 11800],
    // Match - GSTN, Date (2 entries, different invoice numbers)
    ['Match - GSTN, Date', '04-Mar-2025', '33ABCDE5678F1Z5', 'Supplier C', 'INV003', 12000, 2160, 0, 0, 14160],
    ['Match - GSTN, Date', '04-Mar-2025', '33ABCDE5678F1Z5', 'Supplier C', 'INV004', 6000, 1080, 0, 0, 7080],
    // Match - GSTN (2 entries, different invoice numbers and dates)
    ['Match - GSTN', '05-Mar-2025', '27AABCU9603R2ZM', 'Supplier C', 'INV005', 8000, 1440, 0, 0, 9440],
    ['Match - GSTN', '06-Mar-2025', '27AABCU9603R2ZM', 'Supplier C', 'INV006', 4000, 720, 0, 0, 4720],
    // Unmatch - GSTN Not Exist (1 entry, GSTN not in GSTR-2B)
    ['Unmatch - GSTN Not Exist', '07-Mar-2025', '88UNIQUE1234Z', 'Supplier Z', 'INV015', 10000, 1800, 0, 0, 11800],
    // Unmatch - Amt Diff (2 entries, same invoice number, different amounts)
    ['Unmatch - Amt Diff', '09-Mar-2025', '27AABCU9603R1ZM', 'Supplier A', 'INV009', 10000, 1800, 0, 0, 11800], // Differs from GSTR-2B
    ['Unmatch - Amt Diff', '09-Mar-2025', '27AABCU9603R1ZM', 'Supplier A', 'INV009', 5000, 250, 0, 0, 5250],  // Differs from GSTR-2B
    // Unmatch (2 entries, extra invoices)
    ['Unmatch', '12-Mar-2025', '33ABCDE5678F1Z5', 'Supplier C', 'INV013', 7000, 1260, 0, 0, 8260], // Extra invoice
    ['Unmatch', '13-Mar-2025', '29XYZ1234P1ZQ', 'Supplier B', 'INV014', 9000, 0, 810, 810, 10620], // Extra invoice

  ];
        const ws2 = XLSX.utils.aoa_to_sheet(gstr3bSample);
        gstr3bSampleHeaders.forEach((_, index) => {
          const cell = ws2[XLSX.utils.encode_cell({ r: 0, c: index })];
          if (cell) cell.s = { fill: { fgColor: { rgb: 'E0FFFF' } } };
        });
        XLSX.utils.book_append_sheet(wb, ws2, 'Client Data');

        const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
        const blob = new Blob([wbout], { type: 'application/octet-stream' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'Sample_GST_Reconciliation.xlsx';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }

      function normalizeRow(row, headerLength) {
        const normalized = new Array(headerLength).fill('');
        row.forEach((cell, index) => {
          if (index < headerLength) normalized[index] = cell === undefined || cell === null ? '' : cell;
        });
        return normalized;
      }

      function handleFileUpload(event) {
        const file = event.target.files[0];
        const reader = new FileReader();
        reader.onload = function(e) {
          const data = new Uint8Array(e.target.result);
          const workbook = XLSX.read(data, { type: 'array', dateNF: 'dd-mmm-yyyy' });
          const gstr2bSheet = workbook.Sheets['GST Portal'];
          if (gstr2bSheet) {
            const rawData = XLSX.utils.sheet_to_json(gstr2bSheet, { header: 1, raw: true, defval: '' });
            gstr2bData = rawData.slice(1).map(row => normalizeRow(row, gstr2bHeaders().length));
            localStorage.setItem('gstr2bData', JSON.stringify(gstr2bData));
            displayData(gstr2bData, 'gstr2b-container', gstr2bHeaders(), 'gstr2b');
          }
          const gstr3bSheet = workbook.Sheets['Client Data'];
          if (gstr3bSheet) {
            const rawData = XLSX.utils.sheet_to_json(gstr3bSheet, { header: 1, raw: true, defval: '' });
            gstr3bData = rawData.slice(1).map(row => normalizeRow(row, gstr3bHeaders().length));
            localStorage.setItem('gstr3bData', JSON.stringify(gstr3bData));
            displayData(gstr3bData, 'gstr3b-container', gstr3bHeaders(), 'gstr3b');
          }
          reconcileData();
        };
        reader.readAsArrayBuffer(file);
      }

      // Updated displayData function to properly format dates
      function displayData(data, containerId, headers, sheetType) {
        const container = document.getElementById(containerId);
        const isFreeService = localStorage.getItem("isFreeService") === "true";
        let html = '<table><thead><tr>';
        headers.forEach(header => html += `<th>${header}</th>`);
        html += '</tr></thead><tbody>';
        
        // Find date column indices
        const dateColumnIndexes = [];
        headers.forEach((header, index) => {
          if (header.toLowerCase().includes('date')) {
            dateColumnIndexes.push(index);
          }
        });
        
        data.forEach((row, rowIndex) => {
          html += `<tr data-row="${rowIndex}" data-sheet="${sheetType}">`;
          headers.forEach((header, colIndex) => {
            const cell = row[colIndex];
            
            // Format date columns
            let value;
            if (dateColumnIndexes.includes(colIndex)) {
              value = formatDate(cell);
            } else {
              value = cell === undefined || cell === null ? '' : cell;
            }
            
            const isEditable = colIndex > 0 && !isFreeService; // Only editable for normal users
            html += `<td contenteditable="${isEditable}" data-col="${colIndex}">${value}</td>`;
          });
          html += '</tr>';
        });
        html += '</tbody></table>';
        container.innerHTML = html;
        const table = container.querySelector('table');
        table.addEventListener('input', handleCellEdit);
        if (filterEnabled) toggleFilters(); // Reapply filters if enabled
        
        // Apply free service restrictions and colors
        if (isFreeService) {
          const cells = table.querySelectorAll("td");
          cells.forEach(cell => {
            cell.setAttribute("contenteditable", "false");
          });
          applyFreeServiceColors(); // Colors apply karo
        }
      }

      // Updated handleCellEdit function to handle date formatting
      function handleCellEdit(event) {
        const target = event.target;
        const isFreeService = localStorage.getItem("isFreeService") === "true";
        
        if (isFreeService) {
          event.preventDefault(); // Prevent editing in free service mode
          target.blur(); // Remove focus from cell
          return;
        }

        if (target.tagName === 'TD' && target.hasAttribute('contenteditable') && target.getAttribute('contenteditable') === 'true') {
          const rowIndex = parseInt(target.parentElement.getAttribute('data-row'), 10);
          const colIndex = parseInt(target.getAttribute('data-col'), 10);
          const sheetType = target.parentElement.getAttribute('data-sheet');
          const newValue = target.textContent.trim();
          
          // Check if this is a date column
          const headers = sheetType === 'gstr2b' ? gstr2bHeaders() : gstr3bHeaders();
          const isDateColumn = headers[colIndex].toLowerCase().includes('date');
          
          // Format date if needed
          const valueToStore = isDateColumn ? formatDateForStorage(newValue) : newValue;
          
          if (sheetType === 'gstr2b') {
            gstr2bData[rowIndex][colIndex] = valueToStore;
            localStorage.setItem('gstr2bData', JSON.stringify(gstr2bData));
          } else if (sheetType === 'gstr3b') {
            gstr3bData[rowIndex][colIndex] = valueToStore;
            localStorage.setItem('gstr3bData', JSON.stringify(gstr3bData));
          }
          
          // If it's a date column, display the formatted date
          if (isDateColumn) {
            target.textContent = formatDate(valueToStore);
          }
          
          reconcileData();
          // Filter refresh karna jab filter enabled ho
          if (filterEnabled) {
            refreshFilters(sheetType === 'gstr2b' ? 'gstr2b-container' : 'gstr3b-container');
          }
        }
      }

     function normalizeInvoiceNumber(invNum) {
       return invNum.replace(/[\s\/\\.,"?\']/g, '');
     }
      

    
    
